<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>PDV Barbearia</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:url("https://images.unsplash.com/photo-1503951914875-452162b0f3f1");
  background-size:cover;
  background-position:center;
}
.overlay{
  background:rgba(0,0,0,.65);
  min-height:100vh;
}
.menu{
  position:fixed;
  left:0;
  top:0;
  bottom:0;
  width:70px;
  background:rgba(0,0,0,.35);
  display:flex;
  flex-direction:column;
  align-items:center;
  padding-top:20px;
}
.menu button{
  background:none;
  border:none;
  color:#f1c40f;
  font-size:22px;
  margin:15px 0;
  cursor:pointer;
}
.menu button:hover{
  transform:scale(1.2);
}
.content{
  margin-left:90px;
  padding:20px;
  color:#fff;
}
.section{display:none}
.section.active{display:block}

input,select,button{
  padding:10px;
  border-radius:6px;
  border:none;
}
button{cursor:pointer;font-weight:bold}

table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border-bottom:1px solid rgba(255,255,255,.2);
  padding:6px;
}

.total{
  font-size:24px;
  color:#2ecc71;
  margin-top:10px;
}
</style>
</head>

<body>
<div class="overlay">

<!-- MENU TRANSPARENTE -->
<div class="menu">
  <button onclick="show('pdv')">ðŸ’ˆ</button>
  <button onclick="show('agenda')">ðŸ“…</button>
  <button onclick="show('estoque')">ðŸ“¦</button>
  <button onclick="show('historico')">ðŸ“Š</button>
  <button onclick="show('caixa')">ðŸ’°</button>
</div>

<div class="content">

<!-- PDV -->
<div id="pdv" class="section active">
  <h2>PDV</h2>
  <select id="cliente"></select>
  <select id="produto"></select>
  <button onclick="addCarrinho()">Adicionar</button>

  <table id="carrinho"></table>
  <div class="total">Total: R$ <span id="total">0.00</span></div>

  <button onclick="finalizarVenda()">Finalizar Venda</button>
</div>

<!-- AGENDA -->
<div id="agenda" class="section">
  <h2>Agenda</h2>
  <input type="date" id="dataAgenda">
  <input type="time" id="horaAgenda">
  <input placeholder="Cliente" id="clienteAgenda">
  <input placeholder="ServiÃ§o" id="servicoAgenda">
  <button onclick="salvarAgenda()">Salvar HorÃ¡rio</button>
  <ul id="listaAgenda"></ul>
</div>

<!-- ESTOQUE -->
<div id="estoque" class="section">
  <h2>Estoque</h2>
  <input placeholder="Produto" id="nomeProd">
  <input type="number" placeholder="Valor" id="valorProd">
  <input type="number" placeholder="Qtd" id="qtdProd">
  <button onclick="salvarProduto()">Salvar</button>
  <ul id="listaEstoque"></ul>
</div>

<!-- HISTÃ“RICO -->
<div id="historico" class="section">
  <h2>HistÃ³rico de Vendas</h2>
  <ul id="listaHistorico"></ul>
</div>

<!-- CAIXA -->
<div id="caixa" class="section">
  <h2>Caixa</h2>
  <p id="statusCaixa">Caixa fechado</p>
  <button onclick="abrirCaixa()">Abrir Caixa</button>
  <button onclick="fecharCaixa()">Fechar Caixa</button>
</div>

</div>
</div>

<script>
const db = JSON.parse(localStorage.getItem("db")) || {
  clientes:["Cliente PadrÃ£o"],
  produtos:[],
  agenda:[],
  vendas:[],
  caixa:{aberto:false, abertura:0}
};

let carrinho=[];

function save(){ localStorage.setItem("db",JSON.stringify(db)); }

function show(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  render();
}

function render(){
  cliente.innerHTML=db.clientes.map(c=>`<option>${c}</option>`).join("");
  produto.innerHTML=db.produtos.map(p=>`<option>${p.nome}|${p.valor}</option>`).join("");

  carrinho.innerHTML="<tr><th>Item</th><th>Valor</th></tr>"+
    carrinho.map(i=>`<tr><td>${i.nome}</td><td>R$ ${i.valor.toFixed(2)}</td></tr>`).join("");

  total.innerText=carrinho.reduce((s,i)=>s+i.valor,0).toFixed(2);

  listaAgenda.innerHTML=db.agenda.map(a=>`<li>${a.data} ${a.hora} - ${a.cliente}</li>`).join("");
  listaEstoque.innerHTML=db.produtos.map(p=>`<li>${p.nome} (${p.qtd})</li>`).join("");
  listaHistorico.innerHTML=db.vendas.map(v=>`<li>${v.data} - R$ ${v.total}</li>`).join("");

  statusCaixa.innerText=db.caixa.aberto?"ðŸŸ¢ Caixa aberto":"ðŸ”´ Caixa fechado";
}

function addCarrinho(){
  const [nome,valor]=produto.value.split("|");
  carrinho.push({nome,valor:Number(valor)});
  render();
}

function finalizarVenda(){
  if(!db.caixa.aberto) return alert("Abra o caixa");
  const totalVenda=carrinho.reduce((s,i)=>s+i.valor,0);
  db.vendas.push({data:new Date().toLocaleString(),total:totalVenda});
  carrinho=[];
  save(); render();
}

function salvarAgenda(){
  db.agenda.push({
    data:dataAgenda.value,
    hora:horaAgenda.value,
    cliente:clienteAgenda.value,
    servico:servicoAgenda.value
  });
  save(); render();
}

function salvarProduto(){
  db.produtos.push({
    nome:nomeProd.value,
    valor:Number(valorProd.value),
    qtd:Number(qtdProd.value)
  });
  save(); render();
}

function abrirCaixa(){
  const v=Number(prompt("Valor de abertura"));
  if(isNaN(v)) return;
  db.caixa={aberto:true, abertura:v};
  save(); render();
}

function fecharCaixa(){
  db.caixa={aberto:false, abertura:0};
  save(); render();
}

render();
</script>

</body>
</html>
